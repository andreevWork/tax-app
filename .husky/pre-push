#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

current_branch=$(git branch --show-current)

echo "ğŸ” Checking branch naming convention..."

if [ "$current_branch" = "main" ]; then
  echo "âœ… Skipping branch name check for $current_branch"
  exit 0
fi

if ! echo "$current_branch" | grep -qE '^TAX-\d+/[a-zA-Z0-9-]+$'; then
  echo "âŒ Invalid branch name: '$current_branch'"
  echo ""
  echo "ğŸ“‹ Branch naming rules:"
  echo "   - Format: TAX-<number>/<description>"
  echo "   - Example: TAX-3/setup-vitest"
  echo "   - Use letters, numbers and hyphens in description"
  echo ""
  echo "ğŸ’¡ How to fix:"
  echo "   git branch -m <new-correct-name>"
  echo "   Example: git branch -m TAX-3/setup-vitest"
  echo ""
  exit 1
fi

echo "âœ… Branch name is valid: $current_branch"
